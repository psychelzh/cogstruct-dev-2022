[
  {
    "objectID": "about.html",
    "href": "about.html",
    "title": "About",
    "section": "",
    "text": "We are from Beijing Normal University. We have developed more than 50 tasks based on psychological paradigms, in order to explore the structure of human cognition."
  },
  {
    "objectID": "index.html",
    "href": "index.html",
    "title": "Cognitive Structure Project",
    "section": "",
    "text": "Aug 21, 2022\n\n\nLiang Zhang\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nstructure\n\n\ncognition\n\n\nmeta-analysis\n\n\n\n\n\n\n\n\n\n\n\nMay 10, 2022\n\n\nYifei Cao, Liang Zhang\n\n\n\n\n\n\nNo matching items"
  },
  {
    "objectID": "posts/explore-struct-overall/index.html",
    "href": "posts/explore-struct-overall/index.html",
    "title": "Explore Cognitive Structure",
    "section": "",
    "text": "Code\nlibrary(tidyverse)\nlibrary(corrr)\nlibrary(showtext)\nlibrary(gt)\nlibrary(formattable)\nlibrary(patchwork)\nlibrary(psych)\nrequireNamespace(\"bit64\")"
  },
  {
    "objectID": "posts/explore-struct-overall/index.html#original-form",
    "href": "posts/explore-struct-overall/index.html#original-form",
    "title": "Explore Cognitive Structure",
    "section": "Original Form",
    "text": "Original Form\n\n\nCode\nindices |> \n  mutate(facet_title = str_c(game_name, index_name, sep = \"\\n\")) |> \n  ggplot(aes(test)) + \n  geom_histogram(bins = 30) +\n  facet_wrap(~facet_title, scales = \"free\", ncol = 5) +\n  labs(x = \"Raw Score\", y = \"Count\") +\n  theme_bw()\n\n\n\n\n\nFigure 1: Histogram of All Game Indices\n\n\n\n\n\n\nCode\nindices |> \n  mutate(facet_title = str_c(game_name, index_name, sep = \"\\n\")) |> \n  ggplot(aes(sample = test)) + \n  geom_qq() +\n  geom_qq_line() +\n  facet_wrap(~facet_title, scales = \"free\", ncol = 5) +\n  labs(x = \"Expected Quantile\", y = \"Observed Quantile\") +\n  theme_bw()\n\n\n\n\n\nFigure 2: QQ-plot of All Game Indices\n\n\n\n\nAccording to a classic book (Kline 2016), critical value for absolute skewness is 3, and critical value for absolute kurtosis is 10; thus, these indices are all not too apart from normal distribution. But see Figure 1, we detect some heavily skewed indices. Just as a classic book (Bulmer 1979) said, critical value for skewness is 0.5 (moderately skew) and 1 (highly skew).\n\n\nCode\nindices_stats |> \n  mutate(across(mean:kurtosis, ~ digits(., 3))) |> \n  formattable() |> \n  as.datatable(\n    caption = \"Descriptive Statistics of All Indices\"\n  )"
  },
  {
    "objectID": "posts/explore-struct-overall/index.html#transformed",
    "href": "posts/explore-struct-overall/index.html#transformed",
    "title": "Explore Cognitive Structure",
    "section": "Transformed",
    "text": "Transformed\nHere we decide to convert the moderately and highly indices based on the conversion suggested by Howell (2013).\n\n\nCode\nindices |> \n  inner_join(\n    indices_stats |> \n      select(game_name, index_name, skew, skew_status) |> \n      filter(skew_status != \"acceptable\"), \n    by = c(\"game_name\", \"index_name\")\n  ) |> \n  group_nest(game_name, index_name, skew, skew_status) |> \n  pmap(show_normality) |> \n  wrap_plots(ncol = 1)\n\n\n\n\n\nFigure 3: Normality Check on Suspected Skew Indices\n\n\n\n\nFrom Figure 3, it might be a good choice to transform indices with an absolute skewness value larger than 0.5, and logarithmic and square root transformations are used.\n\n\nCode\ngame_needs_trans <- indices_stats |>\n  filter(abs(skew) > 0.5)\nindices_trans <- indices |> \n  group_by(game_name, index_name) |> \n  group_modify(\n    ~ .x |> \n      mutate(\n        across(\n          c(test, retest),\n          transform_indices,\n          game_name = .y$game_name,\n          index_name = .y$index_name,\n          .names = \"{.col}_trans\"\n        )\n      )\n  ) |> \n  ungroup() |> \n  mutate(score_trans = if_else(reversed == \"yes\", -test_trans, test_trans))\nindices_stats_trans <- summary_data(indices_trans, name_value = \"test_trans\")\n\n\n\n\nCode\nindices_trans |> \n  inner_join(indices_stats_trans, by = c(\"game_name\", \"index_name\")) |> \n  semi_join(game_needs_trans, by = c(\"game_name\", \"index_name\")) |> \n  group_nest(game_name, index_name, skew, skew_status) |> \n  pmap(show_normality, name_value = \"test_trans\") |> \n  wrap_plots(ncol = 1)\n\n\n\n\n\nFigure 4: Normality Check after Transformations\n\n\n\n\nFrom Figure 4, we know these indices now perform very well on normality. The transformations seem to be useful."
  },
  {
    "objectID": "posts/explore-struct-overall/index.html#bartletts-test",
    "href": "posts/explore-struct-overall/index.html#bartletts-test",
    "title": "Explore Cognitive Structure",
    "section": "Bartlett’s Test",
    "text": "Bartlett’s Test\n\n\nCode\nlist(\n  Whole = indices_wider_bare,\n  `Sichuan Dataset` = indices_wider_bare_sic,\n  `Beijing Dataset` = indices_wider_bare_bj\n) |> \n  map(\n    ~ psych::cortest.bartlett(.) |> \n      as_tibble()\n  ) |> \n  bind_rows(.id = \"Data Source\") |> \n  knitr::kable(digits = 2)\n\n\n\n\nTable 1: Bartlett Test for Different Dataset\n\n\nData Source\nchisq\np.value\ndf\n\n\n\n\nWhole\n5611.36\n0\n820\n\n\nSichuan Dataset\n3528.74\n0\n820\n\n\nBeijing Dataset\nNaN\nNaN\n820\n\n\n\n\n\n\nTable 1 shows that Beijing data set is not appropriate for further analysis, because the correlation matrix is not positive definite. Further check on the data shows there is only 21 complete cases, which corrupts the data set. But the whole data set and Sichuan sub data set are all suitable for further analysis."
  },
  {
    "objectID": "posts/explore-struct-overall/index.html#sampling-adequacy",
    "href": "posts/explore-struct-overall/index.html#sampling-adequacy",
    "title": "Explore Cognitive Structure",
    "section": "Sampling Adequacy",
    "text": "Sampling Adequacy\nKMO test: this test will give us an index of how well the matrix is suited for factor analysis. The criteria suggested by Kaiser (1974):\n\n\n\nCode\nkmo_result <- psych::KMO(indices_wider_bare)\nkmo_result_sic <- psych::KMO(indices_wider_bare_sic)\nbind_rows(\n  whole = kmo_result$MSAi |> \n    enframe(name = \"game_index_name\", value = \"MSA\"),\n  sichuan = kmo_result_sic$MSAi |> \n    enframe(name = \"game_index_name\", value = \"MSA\"),\n  .id = \"src\"\n) |> \n  separate(game_index_name, c(\"game_name\", \"index_name\"), sep = \"\\\\.\") |> \n  mutate(MSA = digits(MSA, 2)) |> \n  pivot_wider(\n    names_from = src,\n    values_from = MSA,\n    names_prefix = \"MSA_\"\n  ) |> \n  formattable() |> \n  as.datatable(caption = \"KMO Test Result\")\n\n\n\n\n\n\n\n\nFor the whole data set, the overall MSA value is 0.87. However, there are 0 indices with MSA value lower than 0.6, which is generally acceptable.\nFor the Sichuan data set, the overall MSA value is 0.79. However, there are 2 indices with MSA value lower than 0.6, which is generally acceptable."
  },
  {
    "objectID": "posts/explore-struct-overall/index.html#determining-number-of-factors",
    "href": "posts/explore-struct-overall/index.html#determining-number-of-factors",
    "title": "Explore Cognitive Structure",
    "section": "Determining Number of Factors",
    "text": "Determining Number of Factors\n\n\nCode\nn_factor_whole <- psych::nfactors(indices_wider_bare)\n\n\nCode\nn_factor_sic <- psych::nfactors(indices_wider_bare_sic)\n\n\n\n\nCode\nformat_n_factors <- function(n_factor_result) {\n  checks <- c(\"BIC\", \"SABIC\", \"eBIC\", \"MAP\")\n  n_factor_result$vss.stats |>\n    as_tibble() |>\n    select(BIC, SABIC, eBIC) |>\n    mutate(n_factor = seq_len(n()), .before = 1L) |>\n    add_column(MAP = n_factor_result$map) |> \n    gt() |> \n    fmt_number(\n      -c(n_factor, MAP),\n      decimals = 0\n    ) |>\n    fmt_scientific(MAP) |>\n    tab_style(\n      style = cell_text(weight = \"bold\"),\n      locations = map(\n        checks,\n        ~ cells_body(\n          columns = all_of(.x),\n          rows = !!sym(.x) == min(!!sym(.x))\n        )\n      )\n    ) |> \n    as_raw_html()\n}\n\nformat_n_factors(n_factor_whole)\nformat_n_factors(n_factor_sic)\n\n\n\nTable 2: Number of Factors Tests\n\n\n\n\n(a) Whole Dataset \n  \n  \n    \n      n_factor\n      BIC\n      SABIC\n      eBIC\n      MAP\n    \n  \n  \n    1\n−2,184\n288\n−708\n9.29 × 10−3\n    2\n−2,446\n−101\n−1,897\n7.97 × 10−3\n    3\n−2,572\n−351\n−2,380\n7.66 × 10−3\n    4\n−2,559\n−458\n−2,532\n7.92 × 10−3\n    5\n−2,515\n−531\n−2,594\n8.20 × 10−3\n    6\n−2,463\n−593\n−2,605\n8.58 × 10−3\n    7\n−2,385\n−627\n−2,561\n9.28 × 10−3\n    8\n−2,264\n−613\n−2,468\n1.01 × 10−2\n    9\n−2,189\n−643\n−2,374\n1.11 × 10−2\n    10\n−2,079\n−634\n−2,273\n1.20 × 10−2\n    11\n−1,965\n−619\n−2,162\n1.30 × 10−2\n    12\n−1,850\n−600\n−2,052\n1.40 × 10−2\n    13\n−1,732\n−573\n−1,932\n1.53 × 10−2\n    14\n−1,613\n−543\n−1,808\n1.65 × 10−2\n    15\n−1,513\n−529\n−1,683\n1.84 × 10−2\n    16\n−1,393\n−491\n−1,552\n2.00 × 10−2\n    17\n−1,272\n−450\n−1,423\n2.19 × 10−2\n    18\n−1,163\n−417\n−1,302\n2.41 × 10−2\n    19\n−1,061\n−389\n−1,180\n2.63 × 10−2\n    20\n−957\n−354\n−1,066\n2.90 × 10−2\n  \n  \n  \n\n\n\n\n\n\n(b) Sichuan Dataset \n  \n  \n    \n      n_factor\n      BIC\n      SABIC\n      eBIC\n      MAP\n    \n  \n  \n    1\n−2,366\n105\n−946\n1.13 × 10−2\n    2\n−2,496\n−152\n−1,877\n9.84 × 10−3\n    3\n−2,535\n−315\n−2,269\n9.23 × 10−3\n    4\n−2,475\n−376\n−2,377\n9.47 × 10−3\n    5\n−2,396\n−414\n−2,408\n9.82 × 10−3\n    6\n−2,344\n−476\n−2,421\n1.03 × 10−2\n    7\n−2,262\n−505\n−2,390\n1.09 × 10−2\n    8\n−2,167\n−518\n−2,319\n1.17 × 10−2\n    9\n−2,065\n−520\n−2,237\n1.22 × 10−2\n    10\n−1,959\n−516\n−2,137\n1.31 × 10−2\n    11\n−1,845\n−500\n−2,028\n1.41 × 10−2\n    12\n−1,722\n−472\n−1,911\n1.54 × 10−2\n    13\n−1,605\n−448\n−1,797\n1.66 × 10−2\n    14\n−1,501\n−432\n−1,684\n1.79 × 10−2\n    15\n−1,407\n−424\n−1,575\n1.94 × 10−2\n    16\n−1,305\n−404\n−1,461\n2.09 × 10−2\n    17\n−1,194\n−373\n−1,343\n2.27 × 10−2\n    18\n−1,102\n−357\n−1,230\n2.49 × 10−2\n    19\n−1,009\n−337\n−1,117\n2.69 × 10−2\n    20\n−911\n−308\n−1,008\n2.92 × 10−2\n  \n  \n  \n\n\n\n\n\nFrom Table 2, we noticed inconsistencies. So we try factor numbers as 9, 6 and 3.\n\n\nCode\nplotly_efa <- function(model) {\n  heatmaply::heatmaply_cor(\n    t(unclass(model$loadings)),\n    dendrogram = \"column\",\n    k_col = NA,\n    label_format_fun = function(...) round(..., digits = 2),\n    margin = c(50, 50, 50, 0)\n  )\n}"
  },
  {
    "objectID": "posts/explore-struct-overall/index.html#results-of-9-factors",
    "href": "posts/explore-struct-overall/index.html#results-of-9-factors",
    "title": "Explore Cognitive Structure",
    "section": "Results of 9 factors",
    "text": "Results of 9 factors\n\n\nCode\nfitted <- fa(indices_wider_bare, 9)\nplotly_efa(fitted)\n\n\n\n\n\nFigure 7: Nine Factors Result (Whole Dataset)\n\n\n\n\n\nCode\nfitted_sic <- fa(indices_wider_bare_sic, 9)\nplotly_efa(fitted_sic)\n\n\n\n\n\nFigure 8: Nine Factors Result (Sichuan Dataset)"
  },
  {
    "objectID": "posts/explore-struct-overall/index.html#results-of-6-factors",
    "href": "posts/explore-struct-overall/index.html#results-of-6-factors",
    "title": "Explore Cognitive Structure",
    "section": "Results of 6 factors",
    "text": "Results of 6 factors\n\n\nCode\nfitted <- fa(indices_wider_bare, 6)\nplotly_efa(fitted)\n\n\n\n\n\nFigure 9: Six Factors Result (Whole Dataset)\n\n\n\n\n\nCode\nfitted_sic <- fa(indices_wider_bare_sic, 6)\nplotly_efa(fitted_sic)\n\n\n\n\n\nFigure 10: Six Factors Result (Sichuan Dataset)\n\n\n\n\n\nCode\nfitted <- fa(indices_wider_bare, 7, rotate = \"varimin\")\nparameters::model_parameters(fitted, sort = TRUE, threshold = 0.3)"
  },
  {
    "objectID": "posts/explore-struct-overall/index.html#results-of-3-factors",
    "href": "posts/explore-struct-overall/index.html#results-of-3-factors",
    "title": "Explore Cognitive Structure",
    "section": "Results of 3 factors",
    "text": "Results of 3 factors\n\n\nCode\nfitted <- fa(indices_wider_bare, 3)\nplotly_efa(fitted)\n\n\n\n\n\nFigure 11: Three Factors Result (Whole Dataset)\n\n\n\n\n\nCode\nfitted_sic <- fa(indices_wider_bare_sic, 3)\nplotly_efa(fitted_sic)\n\n\n\n\n\nFigure 12: Three Factors Result (Sichuan Dataset)"
  },
  {
    "objectID": "posts/Large-scale meta analysis/index.html",
    "href": "posts/Large-scale meta analysis/index.html",
    "title": "Extracting Cognitive Factors from Large-Scale Meta-Anslysis Data",
    "section": "",
    "text": "To summarize briefly, I followed the step of Beam et al. (2021, Nature Neuroscience) to find evidence for the structure of human cognition. Firstly, filtering all studies that included the testing paradigms that consisted with those used in our project from the database of Neurosynth, I conducted 28 meta-analysis separately on each group of fMRI studies. Thanks to NiMARE (a python research environment for neuroimaging meta-analysis), I could easily perform Multilevel Kernel Density Analysis (MKDA) on hundreds fMRI studies without manually coding.\nHere is the summarize table for the number of included fMRI studies in each meta-analysis."
  },
  {
    "objectID": "posts/Large-scale meta analysis/index.html#traditional",
    "href": "posts/Large-scale meta analysis/index.html#traditional",
    "title": "Extracting Cognitive Factors from Large-Scale Meta-Anslysis Data",
    "section": "Traditional",
    "text": "Traditional\n\n\nCode\nnfactors_test <- psych::nfactors(cor_nonzero)\n\n\n\n\n\n\nCorrelated latent factors\n\n\n\nCode\nfit <- psych::fa(cor_nonzero, 4)\npsych::fa.diagram(fit)\n\n\n\n\n\n\nBifactor model\n\n\n\nCode\nfit_bifac <- psych::omega(total_nonzero, 3, plot = FALSE)\npsych::omega.diagram(fit_bifac)"
  }
]